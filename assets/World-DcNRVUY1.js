import{N as Yt}from"./Navbar-X-vU1tqe.js";import{C as At,V as l,Q as X,b as rt,c as _t,L as Lt,d as x,B as g,e as ct,F as ht,f as s,g as J,h as L,i as kt,j as R,k as Zt,l as zt,m as xt,n as Ht,o as vt,G as Tt,T as jt,p as Ot,M as Dt,O as Rt,q as qt}from"./RenderPass-Bf2Etyv6.js";import{T as Wt,d as Ft}from"./data-DB44m_cc.js";import{_ as Gt,r as dt,j as Bt,c as nt,i as Nt,a as H,b as Ut,u as $,F as pt,e as Vt,o as ot}from"./index-B8ixTLeG.js";const Jt=""+new URL("../World/bag tag.png",import.meta.url).href,$t=""+new URL("../World/worldbg.png",import.meta.url).href,Kt=""+new URL("../World/sky.png",import.meta.url).href,te=""+new URL("../World/scene-tag.png",import.meta.url).href,ee=""+new URL("../icon/delete.png",import.meta.url).href,ie=""+new URL("../World/bag.png",import.meta.url).href,T=new xt,y=new l,k=new l,d=new X,mt={X:new l(1,0,0),Y:new l(0,1,0),Z:new l(0,0,1)},st={type:"change"},ut={type:"mouseDown",mode:null},ft={type:"mouseUp",mode:null},wt={type:"objectChange"};class ne extends At{constructor(n,e=null){super(void 0,e);const i=new ce(this);this._root=i;const o=new he;this._gizmo=o,i.add(o);const r=new de;this._plane=r,i.add(r);const t=this;function a(S,Z){let O=Z;Object.defineProperty(t,S,{get:function(){return O!==void 0?O:Z},set:function(z){O!==z&&(O=z,r[S]=z,o[S]=z,t.dispatchEvent({type:S+"-changed",value:z}),t.dispatchEvent(st))}}),t[S]=Z,r[S]=Z,o[S]=Z}a("camera",n),a("object",void 0),a("enabled",!0),a("axis",null),a("mode","translate"),a("translationSnap",null),a("rotationSnap",null),a("scaleSnap",null),a("space","world"),a("size",1),a("dragging",!1),a("showX",!0),a("showY",!0),a("showZ",!0);const f=new l,E=new l,p=new X,m=new X,u=new l,w=new X,v=new l,b=new l,Q=new l,I=0,Y=new l;a("worldPosition",f),a("worldPositionStart",E),a("worldQuaternion",p),a("worldQuaternionStart",m),a("cameraPosition",u),a("cameraQuaternion",w),a("pointStart",v),a("pointEnd",b),a("rotationAxis",Q),a("rotationAngle",I),a("eye",Y),this._offset=new l,this._startNorm=new l,this._endNorm=new l,this._cameraScale=new l,this._parentPosition=new l,this._parentQuaternion=new X,this._parentQuaternionInv=new X,this._parentScale=new l,this._worldScaleStart=new l,this._worldQuaternionInv=new X,this._worldScale=new l,this._positionStart=new l,this._quaternionStart=new X,this._scaleStart=new l,this._getPointer=oe.bind(this),this._onPointerDown=ae.bind(this),this._onPointerHover=se.bind(this),this._onPointerMove=re.bind(this),this._onPointerUp=le.bind(this),e!==null&&this.connect()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(n){if(this.object===void 0||this.dragging===!0)return;n!==null&&T.setFromCamera(n,this.camera);const e=at(this._gizmo.picker[this.mode],T);e?this.axis=e.object.name:this.axis=null}pointerDown(n){if(!(this.object===void 0||this.dragging===!0||n!=null&&n.button!==0)&&this.axis!==null){n!==null&&T.setFromCamera(n,this.camera);const e=at(this._plane,T,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,ut.mode=this.mode,this.dispatchEvent(ut)}}pointerMove(n){const e=this.axis,i=this.mode,o=this.object;let r=this.space;if(i==="scale"?r="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(r="world"),o===void 0||e===null||this.dragging===!1||n!==null&&n.button!==-1)return;n!==null&&T.setFromCamera(n,this.camera);const t=at(this._plane,T,!0);if(t){if(this.pointEnd.copy(t.point).sub(this.worldPositionStart),i==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),r==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),r==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),o.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(r==="local"&&(o.position.applyQuaternion(d.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(this._quaternionStart)),r==="world"&&(o.parent&&o.position.add(y.setFromMatrixPosition(o.parent.matrixWorld)),e.search("X")!==-1&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(y.setFromMatrixPosition(o.parent.matrixWorld))));else if(i==="scale"){if(e.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),k.set(a,a,a)}else y.copy(this.pointStart),k.copy(this.pointEnd),y.applyQuaternion(this._worldQuaternionInv),k.applyQuaternion(this._worldQuaternionInv),k.divide(y),e.search("X")===-1&&(k.x=1),e.search("Y")===-1&&(k.y=1),e.search("Z")===-1&&(k.z=1);o.scale.copy(this._scaleStart).multiply(k),this.scaleSnap&&(e.search("X")!==-1&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(i==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(y.setFromMatrixPosition(this.camera.matrixWorld));let f=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(y.copy(this.rotationAxis).cross(this.eye))*a):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(mt[e]),y.copy(mt[e]),r==="local"&&y.applyQuaternion(this.worldQuaternion),y.cross(this.eye),y.length()===0?f=!0:this.rotationAngle=this._offset.dot(y.normalize())*a),(e==="E"||f)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),r==="local"&&e!=="E"&&e!=="XYZE"?(o.quaternion.copy(this._quaternionStart),o.quaternion.multiply(d.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),o.quaternion.copy(d.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),o.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(st),this.dispatchEvent(wt)}}pointerUp(n){n!==null&&n.button!==0||(this.dragging&&this.axis!==null&&(ft.mode=this.mode,this.dispatchEvent(ft)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this.traverse(function(n){n.geometry&&n.geometry.dispose(),n.material&&n.material.dispose()})}attach(n){return this.object=n,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(st),this.dispatchEvent(wt),this.pointStart.copy(this.pointEnd))}getRaycaster(){return T}getMode(){return this.mode}setMode(n){this.mode=n}setTranslationSnap(n){this.translationSnap=n}setRotationSnap(n){this.rotationSnap=n}setScaleSnap(n){this.scaleSnap=n}setSize(n){this.size=n}setSpace(n){this.space=n}}function oe(h){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:h.button};{const n=this.domElement.getBoundingClientRect();return{x:(h.clientX-n.left)/n.width*2-1,y:-(h.clientY-n.top)/n.height*2+1,button:h.button}}}function se(h){if(this.enabled)switch(h.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(h));break}}function ae(h){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(h.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(h)),this.pointerDown(this._getPointer(h)))}function re(h){this.enabled&&this.pointerMove(this._getPointer(h))}function le(h){this.enabled&&(this.domElement.releasePointerCapture(h.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(h)))}function at(h,n,e){const i=n.intersectObject(h,!0);for(let o=0;o<i.length;o++)if(i[o].object.visible||e)return i[o];return!1}const K=new Ht,c=new l(0,1,0),yt=new l(0,0,0),gt=new vt,tt=new X,it=new X,C=new l,bt=new vt,F=new l(1,0,0),j=new l(0,1,0),G=new l(0,0,1),et=new l,q=new l,W=new l;class ce extends rt{constructor(n){super(),this.isTransformControlsRoot=!0,this.controls=n,this.visible=!1}updateMatrixWorld(n){const e=this.controls;e.object!==void 0&&(e.object.updateMatrixWorld(),e.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):e.object.parent.matrixWorld.decompose(e._parentPosition,e._parentQuaternion,e._parentScale),e.object.matrixWorld.decompose(e.worldPosition,e.worldQuaternion,e._worldScale),e._parentQuaternionInv.copy(e._parentQuaternion).invert(),e._worldQuaternionInv.copy(e.worldQuaternion).invert()),e.camera.updateMatrixWorld(),e.camera.matrixWorld.decompose(e.cameraPosition,e.cameraQuaternion,e._cameraScale),e.camera.isOrthographicCamera?e.camera.getWorldDirection(e.eye).negate():e.eye.copy(e.cameraPosition).sub(e.worldPosition).normalize(),super.updateMatrixWorld(n)}}class he extends rt{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const n=new _t({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new Lt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=n.clone();i.opacity=.15;const o=e.clone();o.opacity=.5;const r=n.clone();r.color.setHex(16711680);const t=n.clone();t.color.setHex(65280);const a=n.clone();a.color.setHex(255);const f=n.clone();f.color.setHex(16711680),f.opacity=.5;const E=n.clone();E.color.setHex(65280),E.opacity=.5;const p=n.clone();p.color.setHex(255),p.opacity=.5;const m=n.clone();m.opacity=.25;const u=n.clone();u.color.setHex(16776960),u.opacity=.25,n.clone().color.setHex(16776960);const v=n.clone();v.color.setHex(7895160);const b=new x(0,.04,.1,12);b.translate(0,.05,0);const Q=new g(.08,.08,.08);Q.translate(0,.04,0);const I=new ct;I.setAttribute("position",new ht([0,0,0,1,0,0],3));const Y=new x(.0075,.0075,.5,3);Y.translate(0,.25,0);function S(M,B){const P=new R(M,.0075,3,64,B*Math.PI*2);return P.rotateY(Math.PI/2),P.rotateX(Math.PI/2),P}function Z(){const M=new ct;return M.setAttribute("position",new ht([0,0,0,1,1,1],3)),M}const O={X:[[new s(b,r),[.5,0,0],[0,0,-Math.PI/2]],[new s(b,r),[-.5,0,0],[0,0,Math.PI/2]],[new s(Y,r),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new s(b,t),[0,.5,0]],[new s(b,t),[0,-.5,0],[Math.PI,0,0]],[new s(Y,t)]],Z:[[new s(b,a),[0,0,.5],[Math.PI/2,0,0]],[new s(b,a),[0,0,-.5],[-Math.PI/2,0,0]],[new s(Y,a),null,[Math.PI/2,0,0]]],XYZ:[[new s(new J(.1,0),m.clone()),[0,0,0]]],XY:[[new s(new g(.15,.15,.01),p.clone()),[.15,.15,0]]],YZ:[[new s(new g(.15,.15,.01),f.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new g(.15,.15,.01),E.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},z={X:[[new s(new x(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new s(new x(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new s(new x(.2,0,.6,4),i),[0,.3,0]],[new s(new x(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new s(new x(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new s(new x(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new s(new J(.2,0),i)]],XY:[[new s(new g(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new s(new g(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new g(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},St={START:[[new s(new J(.01,2),o),null,null,null,"helper"]],END:[[new s(new J(.01,2),o),null,null,null,"helper"]],DELTA:[[new L(Z(),o),null,null,null,"helper"]],X:[[new L(I,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new L(I,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new L(I,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Mt={XYZE:[[new s(S(.5,1),v),null,[0,Math.PI/2,0]]],X:[[new s(S(.5,.5),r)]],Y:[[new s(S(.5,.5),t),null,[0,0,-Math.PI/2]]],Z:[[new s(S(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new s(S(.75,1),u),null,[0,Math.PI/2,0]]]},Pt={AXIS:[[new L(I,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},Et={XYZE:[[new s(new kt(.25,10,8),i)]],X:[[new s(new R(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new s(new R(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new s(new R(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new s(new R(.75,.1,2,24),i)]]},It={X:[[new s(Q,r),[.5,0,0],[0,0,-Math.PI/2]],[new s(Y,r),[0,0,0],[0,0,-Math.PI/2]],[new s(Q,r),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new s(Q,t),[0,.5,0]],[new s(Y,t)],[new s(Q,t),[0,-.5,0],[0,0,Math.PI]]],Z:[[new s(Q,a),[0,0,.5],[Math.PI/2,0,0]],[new s(Y,a),[0,0,0],[Math.PI/2,0,0]],[new s(Q,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new s(new g(.15,.15,.01),p),[.15,.15,0]]],YZ:[[new s(new g(.15,.15,.01),f),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new g(.15,.15,.01),E),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new s(new g(.1,.1,.1),m.clone())]]},Ct={X:[[new s(new x(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new s(new x(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new s(new x(.2,0,.6,4),i),[0,.3,0]],[new s(new x(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new s(new x(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new s(new x(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new s(new g(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new s(new g(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new g(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new s(new g(.2,.2,.2),i),[0,0,0]]]},Xt={X:[[new L(I,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new L(I,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new L(I,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function A(M){const B=new rt;for(const P in M)for(let D=M[P].length;D--;){const _=M[P][D][0].clone(),N=M[P][D][1],U=M[P][D][2],V=M[P][D][3],Qt=M[P][D][4];_.name=P,_.tag=Qt,N&&_.position.set(N[0],N[1],N[2]),U&&_.rotation.set(U[0],U[1],U[2]),V&&_.scale.set(V[0],V[1],V[2]),_.updateMatrix();const lt=_.geometry.clone();lt.applyMatrix4(_.matrix),_.geometry=lt,_.renderOrder=1/0,_.position.set(0,0,0),_.rotation.set(0,0,0),_.scale.set(1,1,1),B.add(_)}return B}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=A(O)),this.add(this.gizmo.rotate=A(Mt)),this.add(this.gizmo.scale=A(It)),this.add(this.picker.translate=A(z)),this.add(this.picker.rotate=A(Et)),this.add(this.picker.scale=A(Ct)),this.add(this.helper.translate=A(St)),this.add(this.helper.rotate=A(Pt)),this.add(this.helper.scale=A(Xt)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(n){const i=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:it;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let o=[];o=o.concat(this.picker[this.mode].children),o=o.concat(this.gizmo[this.mode].children),o=o.concat(this.helper[this.mode].children);for(let r=0;r<o.length;r++){const t=o[r];t.visible=!0,t.rotation.set(0,0,0),t.position.copy(this.worldPosition);let a;if(this.camera.isOrthographicCamera?a=(this.camera.top-this.camera.bottom)/this.camera.zoom:a=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),t.scale.set(1,1,1).multiplyScalar(a*this.size/4),t.tag==="helper"){t.visible=!1,t.name==="AXIS"?(t.visible=!!this.axis,this.axis==="X"&&(d.setFromEuler(K.set(0,0,0)),t.quaternion.copy(i).multiply(d),Math.abs(c.copy(F).applyQuaternion(i).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="Y"&&(d.setFromEuler(K.set(0,0,Math.PI/2)),t.quaternion.copy(i).multiply(d),Math.abs(c.copy(j).applyQuaternion(i).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="Z"&&(d.setFromEuler(K.set(0,Math.PI/2,0)),t.quaternion.copy(i).multiply(d),Math.abs(c.copy(G).applyQuaternion(i).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="XYZE"&&(d.setFromEuler(K.set(0,Math.PI/2,0)),c.copy(this.rotationAxis),t.quaternion.setFromRotationMatrix(gt.lookAt(yt,c,j)),t.quaternion.multiply(d),t.visible=this.dragging),this.axis==="E"&&(t.visible=!1)):t.name==="START"?(t.position.copy(this.worldPositionStart),t.visible=this.dragging):t.name==="END"?(t.position.copy(this.worldPosition),t.visible=this.dragging):t.name==="DELTA"?(t.position.copy(this.worldPositionStart),t.quaternion.copy(this.worldQuaternionStart),y.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),y.applyQuaternion(this.worldQuaternionStart.clone().invert()),t.scale.copy(y),t.visible=this.dragging):(t.quaternion.copy(i),this.dragging?t.position.copy(this.worldPositionStart):t.position.copy(this.worldPosition),this.axis&&(t.visible=this.axis.search(t.name)!==-1));continue}t.quaternion.copy(i),this.mode==="translate"||this.mode==="scale"?(t.name==="X"&&Math.abs(c.copy(F).applyQuaternion(i).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="Y"&&Math.abs(c.copy(j).applyQuaternion(i).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="Z"&&Math.abs(c.copy(G).applyQuaternion(i).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="XY"&&Math.abs(c.copy(G).applyQuaternion(i).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="YZ"&&Math.abs(c.copy(F).applyQuaternion(i).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="XZ"&&Math.abs(c.copy(j).applyQuaternion(i).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1)):this.mode==="rotate"&&(tt.copy(i),c.copy(this.eye).applyQuaternion(d.copy(i).invert()),t.name.search("E")!==-1&&t.quaternion.setFromRotationMatrix(gt.lookAt(this.eye,yt,j)),t.name==="X"&&(d.setFromAxisAngle(F,Math.atan2(-c.y,c.z)),d.multiplyQuaternions(tt,d),t.quaternion.copy(d)),t.name==="Y"&&(d.setFromAxisAngle(j,Math.atan2(c.x,c.z)),d.multiplyQuaternions(tt,d),t.quaternion.copy(d)),t.name==="Z"&&(d.setFromAxisAngle(G,Math.atan2(c.y,c.x)),d.multiplyQuaternions(tt,d),t.quaternion.copy(d))),t.visible=t.visible&&(t.name.indexOf("X")===-1||this.showX),t.visible=t.visible&&(t.name.indexOf("Y")===-1||this.showY),t.visible=t.visible&&(t.name.indexOf("Z")===-1||this.showZ),t.visible=t.visible&&(t.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),t.material._color=t.material._color||t.material.color.clone(),t.material._opacity=t.material._opacity||t.material.opacity,t.material.color.copy(t.material._color),t.material.opacity=t.material._opacity,this.enabled&&this.axis&&(t.name===this.axis||this.axis.split("").some(function(f){return t.name===f}))&&(t.material.color.setHex(16776960),t.material.opacity=1)}super.updateMatrixWorld(n)}}class de extends s{constructor(){super(new Zt(1e5,1e5,2,2),new _t({visible:!1,wireframe:!0,side:zt,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(n){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),et.copy(F).applyQuaternion(e==="local"?this.worldQuaternion:it),q.copy(j).applyQuaternion(e==="local"?this.worldQuaternion:it),W.copy(G).applyQuaternion(e==="local"?this.worldQuaternion:it),c.copy(q),this.mode){case"translate":case"scale":switch(this.axis){case"X":c.copy(this.eye).cross(et),C.copy(et).cross(c);break;case"Y":c.copy(this.eye).cross(q),C.copy(q).cross(c);break;case"Z":c.copy(this.eye).cross(W),C.copy(W).cross(c);break;case"XY":C.copy(W);break;case"YZ":C.copy(et);break;case"XZ":c.copy(W),C.copy(q);break;case"XYZ":case"E":C.set(0,0,0);break}break;case"rotate":default:C.set(0,0,0)}C.length()===0?this.quaternion.copy(this.cameraQuaternion):(bt.lookAt(y.set(0,0,0),C,c),this.quaternion.setFromRotationMatrix(bt)),super.updateMatrixWorld(n)}}class pe extends Wt{constructor(n){super(),this.data=n.data,this.arrCollect=n.arrCollect,this.object="",this.group=new Tt,this.textureLoader=new jt,this.vmLayout="",this.dataLayout="",this.manager="",this.material="",this.transformControls="",this.currentObject="",this.raycaster=new xt,this.mouse=new Ot,this.arr=[]}initData(){this.flagLoadData=!0}initModel(){}deleteModel(n){let e=[];for(let i=0;i<this.arr.length;i++){let o=this.arr[i].ids-0;n==o?this.scene.remove(this.arr[i]):e.push(this.arr[i])}this.arr=e}addModel(n){console.log(n);let e="";for(let i=0;i<this.data.length;i++)this.data[i].id==n&&(e=this.data[i]);if(e){const{id:i,name:o,modelurl:r,textureurl:t}=e;this.textureLoader.load(t,a=>{const f=new Dt({color:16777215,map:a});new Rt().load(r,p=>{p.name=o,p.traverse(m=>{m.isMesh&&(m.material=f)}),p.ids=i,this.scene.add(p),this.object=p,this.arr.push(this.object)},p=>{console.log("".concat(p.loaded/p.total*100,"% loaded"))},p=>{console.error("An error happened while loading the model:",p)})})}}start(){const n=new qt(150,100);n.position.y=-1,n.material.opacity=.25,n.material.transparent=!0,this.scene.add(n),this.transformControls=new ne(this.camera,this.renderer.domElement),this.transformControls.setSize(1.5);const e=this.transformControls.getHelper();this.scene.add(e),this.transformControls.addEventListener("dragging-changed",i=>{this.controls.enabled=!i.value}),window.addEventListener("keydown",i=>{switch(i.key){case"q":this.transformControls.setSpace(this.transformControls.space==="local"?"world":"local");break;case"w":this.transformControls.setMode("translate");break;case"e":this.transformControls.setMode("rotate");break;case"r":this.transformControls.setMode("scale");break;case"+":case"=":this.transformControls.setSize(this.transformControls.size+.1);break;case"-":case"_":this.transformControls.setSize(Math.max(this.transformControls.size-.1,.1));break;case"x":this.transformControls.showX=!this.transformControls.showX;break;case"y":this.transformControls.showY=!this.transformControls.showY;break;case"z":this.transformControls.showZ=!this.transformControls.showZ;break;case"Escape":this.transformControls.reset();break}}),window.addEventListener("click",this.onMouseClick.bind(this),!1)}onMouseClick(n){let e=document.getElementsByTagName("canvas")[0];this.mouse.x=(n.clientX-e.getBoundingClientRect().left)/e.offsetWidth*2-1,this.mouse.y=-((n.clientY-e.getBoundingClientRect().top)/e.offsetHeight)*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const i=this.raycaster.intersectObjects(this.arr);if(i.length>0){const o=i[0].object;this.currentObject!==o&&(this.currentObject&&this.transformControls.detach(this.currentObject),this.currentObject=o,this.transformControls.attach(this.currentObject))}else this.transformControls.detach(this.currentObject)}initControls(){super.initControls()}render(){super.render()}}const me={icon:[{id:1,fid:1,name:"1-mechine",thumurl:"./icon/icon-id1.png"},{id:2,fid:1,name:"2-milktea",thumurl:"./icon/icon-id2.png"},{id:3,fid:1,name:"3-phone",thumurl:"./icon/icon-id3.png"},{id:4,fid:1,name:"4-startree",thumurl:"./icon/icon-id4.png"},{id:5,fid:1,name:"5-ladder",thumurl:"./icon/icon-id5.png"},{id:6,fid:3,name:"6-cheese",thumurl:"./icon/icon-id6.png"},{id:7,fid:3,name:"7-bed",thumurl:"./icon/icon-id7.png"},{id:8,fid:3,name:"8-balcony",thumurl:"./icon/icon-id8.png"},{id:9,fid:3,name:"9-mango",thumurl:"./icon/icon-id9.png"},{id:10,fid:3,name:"10-peach",thumurl:"./icon/icon-id10.png"},{id:11,fid:2,name:"11-chair",thumurl:"./icon/icon-id11.png"},{id:12,fid:2,name:"12-robot",thumurl:"./icon/icon-id12.png"},{id:13,fid:2,name:"13-cloudtree",thumurl:"./icon/icon-id13.png"},{id:14,fid:2,name:"14-pump",thumurl:"./icon/icon-id14.png"},{id:15,fid:4,name:"15-rainbowtree1",thumurl:"./icon/icon-id15.png"},{id:16,fid:4,name:"16-mirror",thumurl:"./icon/icon-id16.png"},{id:17,fid:4,name:"17-rainbowtree2",thumurl:"./icon/icon-id17.png"},{id:18,fid:4,name:"18-tv",thumurl:"./icon/icon-id18.png"},{id:19,fid:4,name:"19-rainbowhouse",thumurl:"./icon/icon-id19.png"},{id:20,fid:5,name:"20-gaint",thumurl:"./icon/icon-id20.png"},{id:21,fid:5,name:"21-galaxytree",thumurl:"./icon/icon-id21.png"},{id:22,fid:5,name:"22-galaxyhouse",thumurl:"./icon/icon-id22.png"}]},ue={class:"container"},fe=["src"],we={class:"div-panel"},ye=["onClick"],ge=["src","onClick"],be={__name:"World",setup(h){let n=Ft.data,e=me.icon;const i=dt(null),o=dt(null);let r=Bt({iconFilter:[],isShow:!0,btndown:"/World/button-down.png",btnup:"icon/button-up.png"}),t=sessionStorage.getItem("arrCollect");if(t=JSON.parse(t),t)for(let m=0;m<t.length;m++){let u=t[m]-0;for(let w=0;w<e.length;w++){let v=e[w].id;u==v&&r.iconFilter.push(e[w])}}let a="";a=new pe({data:n}),a.load();const f=m=>{r.iconFilter=r.iconFilter.filter(v=>v.id!=m);let u=sessionStorage.getItem("arrCollect");u=JSON.parse(u);let w=[];for(let v=0;v<u.length;v++){let b=u[v]-0;m!=b&&w.push(b)}u=w,sessionStorage.setItem("arrCollect",JSON.stringify(u)),a&&a.deleteModel(m)},E=m=>{a&&a.addModel(m)},p=()=>{r.isShow=!r.isShow,r.isShow?(i.value.classList.remove("note-none"),o.value.classList.remove("note-none"),i.value.classList.add("note-show"),o.value.classList.add("note-show")):(i.value.classList.remove("note-show"),o.value.classList.remove("note-show"),i.value.classList.add("note-none"),o.value.classList.add("note-none"))};return(m,u)=>(ot(),nt(pt,null,[Nt(Yt),H("div",ue,[u[1]||(u[1]=Ut('<img src="'+Jt+'" class="bag-tag" style="position:absolute;width:449px;height:76px;left:0px;top:78px;z-index:2;" data-v-179df4d2><img src="'+$t+'" class="worldbg" style="position:absolute;width:100vw;height:1080px;left:0px;top:0px;z-index:1;" data-v-179df4d2><div id="div_canvas3d" class="threejs-container" data-v-179df4d2></div><img src="'+Kt+'" class="sky" style="position:absolute;width:1399px;height:868px;left:479px;top:78px;z-index:2;" data-v-179df4d2><img src="'+te+'" class="scene-tag" style="position:absolute;width:80px;height:27px;left:1798px;top:919px;z-index:3;" data-v-179df4d2>',5)),H("img",{class:"button-down mp",style:{position:"absolute",width:"135px",height:"41px",left:"156px",top:"127px","z-index":"10"},onClick:u[0]||(u[0]=w=>p()),src:$(r).isShow?$(r).btndown:$(r).btnup},null,8,fe),H("div",{ref_key:"myElement1",ref:i,class:"leftdown"},[H("div",we,[(ot(!0),nt(pt,null,Vt($(r).iconFilter,(w,v)=>(ot(),nt("div",{key:w.id,class:"div-content"},[H("img",{src:ee,class:"deleteicon",onClick:b=>f(w.id)},null,8,ye),H("img",{src:w.thumurl,class:"iconpng mp",onClick:b=>E(w.id)},null,8,ge)]))),128))])],512),H("img",{ref_key:"myElement2",ref:o,src:ie,class:"button-down",style:{position:"absolute",width:"449px",height:"497px",left:"0px",top:"78px","z-index":"1"}},null,512)])],64))}},Me=Gt(be,[["__scopeId","data-v-179df4d2"]]);export{Me as default};
